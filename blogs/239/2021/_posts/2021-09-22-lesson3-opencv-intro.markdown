---
layout: ru/blogs/239/2021/post
title:  "Урок 3: Установка OpenCV, коллаж из объекта на фоне, вебкамера, green-screen (как выставить Working DIR и какие dll подкладывать)"
date:   2021-09-22 00:02:00 +0300
lang:   ru
categories: school239_11_2021_2022
---

Для работы с картинками нужно установить и подключить библиотеку OpenCV:

1) Скачайте [opencv-4.5.1-vc14_vc15.exe](https://github.com/opencv/opencv/releases/download/4.5.1/opencv-4.5.1-vc14_vc15.exe) (это прямая ссылка на файл опубликованный в [репозитории OpenCV](https://github.com/opencv/opencv/releases/tag/4.5.1))

2) Запустите и распакуйте в любую папку (без русских букв в пути), рекомендуется выбрать папкой корень диска ```C:\``` (и после распаковки там появится папка ```C:\opencv```)

3) Обновите свой репозиторий как делали это [ранее](/blogs/239/2021/school239_11_2021_2022/2021/09/14/lesson2-2dvector.html) чтобы у вас появилось третье задание **lesson03**.

4) Мы для сборки нашего проекта используем систему CMake, ей надо сообщить где находится установленная библиотека OpenCV:

5) File->Settings->CMake, в поле "CMake options" впишите ```-DOpenCV_DIR=C:\...\opencv\build\x64\vc14\lib``` (замените троеточие на путь распаковки из шага 2)

6) После нажатия OK обратите внимание что внизу в CMake окошке появились строки успеха включая что-то вроде ```Found OpenCV: C:/.../opencv/build```

7) Если при запуске вы видите ошибку ```Process finished with exit code -1073741515 (0xC0000135)``` - то надо как было в первом задании подложить библиотеку из opencv ближе к нашей программе:

8) Скопируйте из ```C:\...\opencv\build\x64\vc14\bin``` файлы ```opencv_world451.dll``` и ```opencv_world451d.dll``` в папку внутри проекта ```cmake-build-debug\lesson03```

9) Теперь программа запускается, но кидается ошибка ```Exception! Assertion "3428374817241" failed at line NN!``` - посмотрев на эту проверку становится ясно что картинка не считалась, это вызвано тем что путь к картинке указан относительный - т.е. картинка по этому пути ищется относительно места запуска нашей программы, пока что наша программа запускается из папки куда мы только что подложили две библиотечки - из ```cmake-build-debug\lesson03```

10) Но не сложно догадаться что судя по пути к картинке, хочется запускать программу из корня проекта, чтобы это сделать - нажмите сверху справа на выпадающий список ```lesson03greenscreen | Debug``` -> ```Edit Configurations``` -> Working directory: -> либо укажите путь к корню проекта, либо нажмите справа плюсик, и там - ```ProjectFileDir``` (так что теперь рабочей папкой указана переменная ```$ProjectFileDir$```)

11) И т.п. сейчас и в будущем мы будем запускать программу из папки-корня проекта, то удобно переложить сюда те две библиотечки которые мы на шаге 8 положили в ```cmake-build-debug\lesson03``` - переложите их теперь оттуда в корень проекта

12) Убедитесь что программа запускается и начните выполнять ```TODO```
